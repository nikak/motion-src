---
Title: Relative Movement of the Upper Arms in the horisontal Plane
Category: Summary Stats
Tags: summary posture, left and right turning, horisontal, upper arms, upper body, arms
Authors: Nicolek
Summary:  Summary statistics for the motion of the upper arms in the horisontal plane during the 2nd step of the Tai Chi Short Form
Series: Arms
series_index: 3
output: 
  html_document:
    theme: readable
    highlight: pygments
    css: theme/css/rStyle.css
---

```{r, echo=FALSE, cache=FALSE, include=FALSE}
#after tags>>
#Slug: relative-movement-of-the-clavicles-in-the-horisontal-plane
#date after title >> Date: 2010-12-03 10:20
#after date >> Modified: '`r format(Sys.Date(), "%B %d, %Y")`'


library(knitr)
#opts_knit$set( progress = TRUE, verbose = TRUE)
knitr::opts_chunk$set(echo=F, warning=F, message=F, prompt=F, error=F)#
#knitr::opts_chunk$set(results="asis")# true is default behaviour
knitr::opts_chunk$set(fig.width=15,  fig.height = 15)
knitr::opts_chunk$set(dev = 'svg')
knitr::opts_chunk$set(dpi = 130)
##echo=FALSE, results='hide', warning=F, message=FALSE

```


<!---
## This was load_s_0.R inside the /Users/nk/Documents/devPro/R-home/3d/scripts folder
## ---------------------------------------------
## running time: 1.71438578367233
## we selected 2nd SF step for all trials
## SF step: 2, sub-movements: 0
## we padded with 10 frames on the left&right sides for boundary effects
## mallAngl, mallCent, mallEvent were updated to the selected time interval
## mallAngl_alig, mallCent_alig, mallEvent_alig are dtw alighned after (centerRFoot_2+centerLFoot_2)
## InBowStance has selected time intervals for Left to Right BS for alighned data
## mallAnglD, mallCentD are downsampled (frd=15) and not aligned
## mallAngl_aligD, mallCent_aligD are downsampled and aligned
## This was load_s_0_st2_calc0.R inside the /Users/nk/Documents/devPro/R-home/3d/scripts folder
## ---------------------------------------------
## toc: true
##rmarkdown::render(input='/Users/nk/Documents/devPro/R-home/3d/markdown/summaryStatistics/upperArms_1.Rmd',output_file='upperArms_1.html',envir=globalenv())
-->


```{r include=FALSE, cache=FALSE}

 load("/Users/nk/Documents/devPro/R-home/3d/all_load_s_0_st2_calc0.RData", .GlobalEnv)
 
 require(sm)
 require(pander)
 require(reshape2)
 sm.options(verbose=0)
 #class="table table-condensed" and <caption> should be inside table but doesn't work with rmd_reader?
 # panderOptions("table.split.table", Inf)  ## don't split tables
 # panderOptions('knitr.auto.asis', FALSE)
 
```


```{r include=FALSE, cache=FALSE}

normAngl=function(ang){
if(is.finite(ang)){
# reduce the angle  
ang =  ang %% (2*pi); 
#force it to be the positive remainder, so that 0 <= angle < 360  
ang = (ang + (2*pi)) %% (2*pi); 
#force into the minimum absolute value residue class, so that -180 < angle <= 180  
if (ang > pi)ang= ang-(2*pi);
return(ang);
}else return(ang)
}

# returns a nested lists: 1st level for sub-moves, 2nd level for trials
f_getSubMove=function(ang, qa){
  #ang is a 25-list with [1-col-marker and rows-frames] vectors
  mNames=names(qa)#sub_moves
  move=lapply(X=mNames,FUN=f_get1SubMove,ang=ang,qa=qa)
  #str(lapply(X=names(qa),FUN=f_get1SubMove,ang=rdif1,qa=qa)) 
  #>> returns 11-list with each 25-list, each with data vector
  names(move)=names(qa);
  return(move)
}

f_get1SubMove=function(subMov, ang, qa){
#f_get1SubMove('m_1',a=rdif1,qa)
#subMove is the number or string for the sub-move
#qa is a list for all 11 sub-moves; each with 25-id-rows by 2 [end, start] of the frame columns
#ang is a 25-list with [1-col-marker and rows-frames] vectors
    idNames=rownames(qa[[subMov]])#id_trials
    move2=lapply(X=idNames, FUN = f_getSubInterval,subMov,ang,qa=qa)
    #lapply(X=rownames(qa[['m_1']]), FUN = f_getSubInterval,subMov='m_1',ang=rdif1,qa=qa)[[1]][1:2]
    #lapply(X=rownames(qa[[1]]), FUN = f_getSubInterval,subMov=1,ang=rdif1,qa=qa)[[1]][1:2]
    #returns list of 25 with each being vector of time series for subMov
    
    names(move2)=names(ang);
    return(move2)
}

f_getSubInterval = function(idN,subMov,ang,qa){
  #subMove is the number or string for the sub-move
  #idN is a paricular trial id
  # cat(sprintf('idN=%s\n',idN))
  # cat(sprintf('subMov=%s\n',subMov))
      movSt=qa[[subMov]][idN,1];#-buff; 
      movEn=qa[[subMov]][idN,2];#+buff;
      return(ang[[idN]][movSt:movEn])
}


#add 'gr' variable as a group factor (all id_1* >> 0 and all id_2* >> 1)
adGrF=function(a){
  k=array(dim=length(a[,1])); 
  k[grep('id_1',a[,'Var1'])]=0; 
  k[grep('id_2',a[,'Var1'])]=1; 
  a=cbind(a,gr=k)
  return(a)
}

f_getSubMove_collection=function(angCollect, qa){
  #tList >> a collection of 25-lists with vectors (single marker-dim like rdif1)
  #tList=list(rdif1,ldif1,sdif1)
  #tList=lapply(X = angCollect,FUN = f_getSubMove,qa=qa)
  m_tList=lapply(X = tList,FUN = melt)
  names(m_tList)=names(angCollect)#c('rdif1','ldif1','sdif1')
  lapply(X = m_tList,FUN = function(X){
    colnames(X)=c('value','Var1','L1')
    X$Var1=factor(X$Var1)
    X$L1=factor(X$L1)
    X=adGrF(X)
  })
}
#------------------------------------------------------
#--------2 horisontal plane
rdif1=lapply(X=mallAngl, FUN=function(x){a=(x[,'sp4_1']-x[,'mRELBOW_1']);
#a=180/pi*normAngl(a)
a=180/pi*sapply(a,FUN=normAngl);
return(a);})
#Protraction/retraction left
ldif1=lapply(X=mallAngl, FUN=function(x){a=(x[,'mLELBOW_1']-x[,'sp4_1']);
a=180/pi*sapply(a,FUN=normAngl);
#a=180/pi*normAngl(a)
return(a);})
#Symmetry 
sdif1=lapply(X=mallAngl, FUN=function(x){
  a=(x[,'mRELBOW_1']-x[,'mLELBOW_1']);
  a=180/pi*a;
# a=(x[,'mLELBOW_1']);
# b=(x[,'mRELBOW_1'] + (2*pi)) %% (2*pi);
# a=180/pi*(b-a);
#a=180/pi*sapply(a,FUN=normAngl);
return(a);})
#------1 verticals

tList=list(rdif1,ldif1,sdif1)
names(tList)=c('rdif1','ldif1','sdif1')

gr1Names=grep('id_1',names(rdif1))
gr2Names=grep('id_2',names(rdif1))
l1=length(gr1Names)
l2=length(gr2Names)
c2gr=c(replicate(l1,'brown'),replicate(l2,'green'))

# find indexes for all avaliable sub-movement eventCodes for each of the 25 persons
# we should get 12x25 matrix for 11 sub-movements of the 2nd step of the Short Form
eventIndexes=sapply(mallEvent,FUN=function(x){which(x>0)})
# create a list with each element being a 25x2 matrix with
# rows for each trial and 2 columns for their frames for end/str of the sub-movement
qa=lapply(X=1:length(eventIndexes[,1]),FUN=function(X,a){if(X<length(a[,1]))
    return(cbind(a[X,],a[(X+1),]))},a=eventIndexes)
qa[12]=NULL; names(qa)=paste('m',1:length(qa),sep='_')
#------------------------------------------------------
#new code
tList=lapply(X = tList,FUN = f_getSubMove,qa=qa)
m_tList=f_getSubMove_collection(tList, qa)
#------------------------------------------------------
#code 2001 values at the beginning of the form
#values at the beginning of the form
t2001=sapply(X = names(rdif1),FUN = function(X,a1,a2){
  #upper arms angles -------
  #allAngl[[1]][which(allEvent[[1]]==2001),'mLELBOW_1']*180/pi=31.62072
  #allAngl[[1]][which(allEvent[[1]]==2001),'mRELBOW_1']*180/pi= 125.9609
  #allAngl[[1]][which(allEvent[[1]]==2001),'sp4_1']*180/pi=-92.55338
  k=which(a2[[X]]==2001)# 2001start of SF WuJi
  h1=(a1[[X]][k,'sp4_1']-a1[[X]][k,'mRELBOW_1'])
  h1=180/pi*(h1)
  #h1=180/pi*normAngl(h1)
  
  h2=(a1[[X]][k,'mLELBOW_1']-a1[[X]][k,'sp4_1'])
  h2=180/pi*(h2)
  #h2=180/pi*normAngl(h2)
  
  h3=(a1[[X]][k,'mRELBOW_1']-a1[[X]][k,'mLELBOW_1'])
  h3=360-180/pi*(h3)
  #h3=180/pi*normAngl(h3)

  h=cbind(h1,h2,h3)
  return(h)
},a1=allAngl,a2=allEvent)

t2001=t(t2001)#1 is azimuth, 2 is elevation
colnames(t2001)=names(tList)#c('mRELBOW_1','mRELBOW_2','mLELBOW_1','mLELBOW_2','sp4_1','su5_2')
t2001=cbind(t2001,gr=c(replicate(length(gr1Names),0),replicate(length(gr2Names),1)))
t2001=as.data.frame(t2001, optional = F)
#------------------------------------------------------
#spine as reference
rbLE=lapply(X=mallAngl, FUN=function(x){a=(x[,'sp4_1']*180/pi);})
rbLE_2bow=f_getSubMove(a=rbLE, qa=a1)#only azimuth angles for ribcage
rbLE_2bow=melt(rbLE_2bow)

```


# How the upper arms move relatively to the ribcage in the horisontal plane?

We need to look at upper arm representations that are given by two lines that connect marker bony parts of the shoulder joints (RSH and LSH) and mid elbow markers (mRELBOW and mLELBOW). These two lines (for right and left) reflect motion of the upper arms. Thus we can estimate their movement in horizontal plane relatively to the ribcage by looking at azimuth angles of these lines and the ribcage. 

For the ribcage representation we take the spinal plane that represents the mid part of the ribcage (4th plane). This plane models a part between T7 to T12 vertebras, is perpendicular to the T12L4 line with the forward orientation that is defined by the bottom sternum marker. The azimuth angles are given by the forward points of the plane (sp4_1).

## Summary. Relative orientation of the upper arms in the horisontal plane

The difference in azimuth angles (sp4_1-mRELBOW_1 and mLELBOW_1-sp4_1) are measured relatively to the forward direction of the 4th spinal plane and normalised to take positive values between 0 and 180 degrees. These values are angles from the right and left body upper arms to the mid centre on the right and left sides respectively. The 2nd step of the Short Form has 3 intervals with last two being identical motion sequence: one on the left and one on right side. In contrast the 1st interval involves a full body turn in space by 90 degrees leftwards and thus we don’t include this movement in the summary of the azimuth angles to simplify the matter. 

For the azimuth angles in the 4th to 11 sub-movements we can see that the 1st group has a slightly higher mean value (around 3 degrees) than the 2nd group for the right upper arm and about 10 degrees higher for the left arm. It also seems that in the 1st group max values are about 25 degrees higher and this might indicate that in the position than the elbow is pointing to the sides and backwards the upper arm is much closer to the body in the 1st group than in the 2nd. Similarly the absolute minimum values in the 1st group are about 15 degrees higher and might indicate that in the positions than the arm crosses the midline of the body the upper arm is closer to the torso in the 1st group than in the 2nd.

<p class='p_caption'>Azimuth (T7T12 - mRELBOW) >> 2nd step SF, 4th - 11th sub-movements</p>
``` {r } 

#right upper armand upper chest in horisontal plane
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2' & m_tList[['rdif1']]$L1!='m_3',]

a1=describe(a[a$gr==0,1])
a2=describe(a[a$gr==1,1])
#c('mRELBOW_1','mRELBOW_2','mLELBOW_1','mLELBOW_2','sp4_1','su5_2')
a1=rbind(a1,a2); 
rownames(a1)=c('1st group', '2nd group')
#set.caption('Azimuth (T7T12 - mRELBOW) >> 2nd step SF, 4th - 11th sub-movements')
pander(a1, use.hyphening = TRUE, style='rmarkdown')
```

<p class='p_caption'>Azimuth ( mLELBOW - T7T12)  >> 2nd step SF, 4th - 11th sub-movements</p>
``` {r } 
#-------------left
a=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2' & m_tList[['ldif1']]$L1!='m_3',]
a1=describe(a[a$gr==0,1])
a2=describe(a[a$gr==1,1])
a1=rbind(a1,a2); 
rownames(a1)=c('1st group', '2nd group')
#set.caption('Azimuth ( mLELBOW - T7T12)  >> 2nd step SF, 4th - 11th sub-movements')
pander(a1, use.hyphening = TRUE, style='rmarkdown')
```

<p class='p_caption'>Azimuth (mRELBOW - mLELBOW) >> 2nd step SF, 11 sub-movements</p>
``` {r } 
#-------------------------------symmetry
a=m_tList[['sdif1']]
a1=describe(a[a$gr==0,1])
a2=describe(a[a$gr==1,1])
a1=rbind(a1,a2); 
rownames(a1)=c('1st group', '2nd group')
#set.caption('Azimuth (mRELBOW - mLELBOW) >> 2nd step SF, 11 sub-movements')
pander(a1, use.hyphening = TRUE, style='rmarkdown')
```

``` {r } 
#right azimuth
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2' & m_tList[['rdif1']]$L1!='m_3',]
par(mfrow=c(3,2)) 
par(mar=c(2.5, 2.5, 1.1, 1.5),bty="n")

sm.density.compare(a$value[is.finite(a$value)], a$gr, xlab="degrees",col=c("brown", "green"))
legend("topright", legend=c("1st group", "2nd group"),col=c("brown", "green"), lty=1:2, cex=0.5,box.lty=0)
title(main='Azimuth (T7T12 - mRELBOW) >> 4th-11th')
grid()
abline(v=describe(a[a$gr==0,1])[1],col='brown')
abline(v=describe(a[a$gr==1,1])[1],col='green')

hist(a[,1],main='all trials >> 4th-11th')

#--------------------------------------------left
a=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2' & m_tList[['ldif1']]$L1!='m_3',]
sm.density.compare(a$value[is.finite(a$value)], a$gr, xlab="degrees",col=c("brown", "green"))
legend("topright", legend=c("1st group", "2nd group"),col=c("brown", "green"), lty=1:2, cex=0.5,box.lty=0)
title(main=' Azimuth ( mLELBOW - T7T12)  >> 4th-11th')
grid()
abline(v=describe(a[a$gr==0,1])[1],col='brown')
abline(v=describe(a[a$gr==1,1])[1],col='green')

hist(a[,1],main='all trials >> 4th-11th')

#--------------------------------------------azimuth (mRELBOW-mLELBOW)
a=m_tList[['sdif1']]
sm.density.compare(a$value[is.finite(a$value)], a$gr, xlab="degrees",col=c("brown", "green"))
legend("topright", legend=c("1st group", "2nd group"),col=c("brown", "green"), lty=1:2, cex=0.5,box.lty=0)
title(main='Azimuth (mRELBOW-mLELBOW) >> 1st-11th')
grid()
abline(v=describe(a[a$gr==0,1])[1],col='brown')
abline(v=describe(a[a$gr==1,1])[1],col='green')

hist(a[,1],main='all trials >> 1st-11th')

```

Than data of the 4th to 11th sub-movements is grouped [by trial identities](#pN1) we can notice that value ranges for left and right upper arms seem to be wider in the 1st group than in the 2nd. Also the 2nd group mean values for the left arm seem to be about 10 degrees smaller than in the 1st group and for the right arm in both groups. Than data is grouped [by 11 sub-movements](#pN2) we can notice the lateral symmetry between 4th to 7th and 8th to 11th sub-movements. Boxplots for the right arm in the 1st interval are similar to boxplots for the left arm in the 2nd interval and vice versa; it also clearly shows that different sub-movements involve different amount of the movement in upper arms. Also this movement symmetry in 1st and 2nd intervals is clearly visible in the density plots.

However than data is grouped [by two intervals](#pN3) we also can see that despite the symmetry in the movement all trials have slight differences between corresponding movements of the left and right arms in 2 intervals. For example ‘id_211’ the values ranges for the right upper arm in the 1st interval (green boxplot in the panel for the right side) are slightly wider and have about 7 degrees higher mean than values for the left arm in the 2nd interval (red boxplot in the panel for the left side). The symmetry and these deviations from it become even more visible in the 2 x 4 boxplots panel for 4 phases of the intervals. We also can notice the general trend: the right upper arms moves more than the left in the 1st phase and more or less in the 2nd phase of the 1st interval whereas the left upper arm moves more in the last phase of the 1st interval; the same logic applies for the 2nd interval (2nd column of the boxplots). Nonetheless different trials seem to have different strategies to distribute the movement between the left and right arms; e.g. ‘id_207’ in the 3rd phase displays more movement in the arm that goes down (left for the 1st interval, right for the 2nd) but ‘id_102’ displays a reversed logic. Also the clear preference for the more movement of the arm that goes down in the last phase of the intervals (left for the 1st interval, right for the 2nd) is different to the movement of the clavicles in the horizontal plane in the same phase as it displayed more movement in the shoulder of the arm that was reaching forwards.

The time series for the angles between the upper arms and midline of the body (the orientation of the ribcage) indicate the difference between the motion of the left and right arms within the same interval (light green vs. orange and dark green vs. red, e.g. ‘id_114’). However the left/right bias is present in most of the trials and we can see it in [the 2nd plot panel](#pN3_p2) at the hand of the differences between these left and right angles to the midline in the 1st and 2nd intervals (dark green vs. red lines); e.g. ‘id_114’ has negatively correlated lines symmetrical to the horizontal axis, ‘id_204’ has lines with similar shape for the same phases of the both intervals but the horizontal symmetry line is about 25 degrees. For the latter example if we look at the previous plot panel we can see that in the ‘id_204’ the left arm in the 2nd interval (red line) has a wider angle than the right arm in the 1st interval thus than we subtract the left values from the right (dark green minus light green and red minus orange) we get a higher result. In other words, this case describes a situation with the forward reaching arm being closer to the body midline in the horizontal plane then it is the right upper arm rather than the left arm. The example of an opposite case is ‘id_206’ with the reaching arm being closer to the midline than it is the left arm but also with the arm that moves downwards being closer to the midline than it is the right arm. Also these differences can be noticed at the hand of the angle between the both upper arms (mRELBOW-mLELBOW) that was calculated without any relation to the orientation of the ribcage (olive and pink lines). Depending on the spatial orientation of the arms this angle can indicate the angle from the forward or back directions with the values that are not easily interpretable in the movement terms; nonetheless they clearly mark the differences between the arm movements in the 1st and 2nd intervals across the trials. [The 3rd plot](#pN3_p3) panel shows the differences between the left and right angles to the midline in the 1st and 2nd intervals (dark green vs. red lines) together with the changes in the orientation of the ribcage (light grey lines for the 1st interval and dark grey for the 2nd).

#### <a name="pN1"></a>Relative orientation of the upper arms in the horisontal plane, grouped by id-trials

Below are boxplots of the upper arm angles relative to the ribcage across different trials for the 4th to 11th sub-movements in the 2nd step of the Short Form. Brown color represents the 1st group and green the 2nd. Horizontal axes are given in degrees of the angles; the vertical axes represent grouping factor – identity of the trial.

``` {r } 
par(mfrow=c(2,2)) 
par(mar=c(2.5, 4.5, 1.1, 1.5))
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2' & m_tList[['rdif1']]$L1!='m_3',]
 
boxplot(value ~ Var1 , data = a,horizontal = TRUE, las=2, col = c2gr,cex.axis=.7, 
        main='T7T12 - mRELBOW >> 4th - 11th' )
grid()
abline(v=mean(a$value[a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1],na.rm = T),col='green')

a=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2' & m_tList[['ldif1']]$L1!='m_3',]
boxplot(value ~ Var1 , data = a,horizontal = TRUE, las=2, col = c2gr,cex.axis=.7,
        main='mLELBOW - T7T12 >> 4th - 11th' )
grid()
abline(v=mean(a$value[a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1],na.rm = T),col='green')

#-----------------------------------
a=m_tList[['sdif1']][m_tList[['sdif1']]$L1!='m_1' & m_tList[['sdif1']]$L1!='m_2' & m_tList[['sdif1']]$L1!='m_3',]
boxplot(value ~ Var1 , data = a,horizontal = TRUE, las=2, col = c2gr,cex.axis=.7,main='mRELBOW-mLELBOW >> 4th - 11th' )
grid()
abline(v=mean(a$value[a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1],na.rm = T),col='green')

a=m_tList[['sdif1']]
boxplot(value ~ Var1 , data = a,horizontal = TRUE, las=2, col = c2gr,cex.axis=.7,main='mRELBOW-mLELBOW >> 1st - 11th' )
grid()
abline(v=mean(a$value[a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1],na.rm = T),col='green')
```


Density plots of the angle values for the sub-movements of two symmetrical intervals (4th to 11th) grouped by the trial identities. 

Brown color represents the right upper arm angles (T7T12 - mRELBOW) for the 1st group and light green the 2nd; vertical lines mark mean value of the corresponding trials. The orange color represents the left angles (T7T12 - mLELBOW)  for the 1st group and dark green the 2nd; vertical lines mark mean value of the corresponding trials. Dark pink color represents the difference angle between the right and left (mRELBOW - mLELBOW).

``` {r } 
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2' & m_tList[['rdif1']]$L1!='m_3',]
b=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2' & m_tList[['ldif1']]$L1!='m_3',]
c=m_tList[['sdif1']][m_tList[['sdif1']]$L1!='m_1' & m_tList[['sdif1']]$L1!='m_2' & m_tList[['sdif1']]$L1!='m_3',]

c2dgr=c(replicate(l1,'dark orange'),replicate(l2,'dark green'))
xl=c(min(a$value,na.rm = T),max(a$value,na.rm = T))
yl=c(0,7/(max(a$value,na.rm = T)-min(a$value,na.rm = T)))
#yl=c(0,.06)

par(mfrow=c(5,5)) 
par(mar=c(2.1, 1.9, 1.1, 1.9))

for(i in 1:length(names(rdif1))){
tN=names(rdif1)[i]
sm.density(a$value[a$Var1==tN], xlab="degrees", xlim=xl,ylim=yl, col=c2gr[i])

sm.density(b$value[b$Var1==tN], xlab="degrees",lty=1, xlim=xl,ylim=yl, col=c2dgr[i],add=T)

sm.density(c$value[c$Var1==tN], xlab="degrees",lty=1, xlim=xl,ylim=yl, col='deeppink',add=T)

title(main=tN)
grid()
abline(v=mean(a$value[a$Var1==tN],na.rm = T),col=c2gr[i])

abline(v=mean(b$value[b$Var1==tN],na.rm = T),col=c2dgr[i],lty=1)

}

```


#### <a name="pN2"></a>Relative orientation of the upper arms in the horisontal plane, grouped by sub-movements

Also we can look at differences in the angles across the 11 sub-movements without differentiating between individual trials. The red color represents the 1st group and green the 2nd. Horizontal axes are given in degrees of the angles and the vertical axes represent grouping factor – a number of the sub-movement.


```{r }

par(mar=c(2.5, 4.5, 1.1, 1.5))
par(mfrow=c(2,1)) 

a=m_tList[['rdif1']]
boxplot(value~L1, data = a, subset=(a$gr==0), horizontal=T,las=2,col=rgb(1,.3,.5, alpha=0.3),medcol="red",add=F, notch=TRUE, varwidth=T,cex.axis=.7, main='Right')

boxplot(value~L1, data = a, subset=(a$gr==1), horizontal=T,las=2,col=rgb(.5,1,.3, alpha=0.6), medcol="green",add=T, varwidth=T,cex.axis=.7)
grid()
a1=mean(sapply(X=unique(a$L1),FUN = function(X,aa){mean(aa$value[aa$gr==0 & aa$L1==X],na.rm = T)},aa=a))
a2=mean(sapply(X=unique(a$L1),FUN = function(X,aa){mean(aa$value[aa$gr==1 & aa$L1==X],na.rm = T)},aa=a))
abline(v=a1,col='brown')
abline(v=a2,col='green')

a=m_tList[['ldif1']]
boxplot(value~L1, data = a, subset=(a$gr==0), horizontal=T,las=2,col=rgb(1,.3,.5, alpha=0.3),medcol="red",add=F, notch=TRUE, varwidth=T,cex.axis=.7, main='Left')

boxplot(value~L1, data = a, subset=(a$gr==1), horizontal=T,las=2,col=rgb(.5,1,.3, alpha=0.6), medcol="green",add=T, varwidth=T,cex.axis=.7)
grid()
a1=mean(sapply(X=unique(a$L1),FUN = function(X,aa){mean(aa$value[aa$gr==0 & aa$L1==X],na.rm = T)},aa=a))
a2=mean(sapply(X=unique(a$L1),FUN = function(X,aa){mean(aa$value[aa$gr==1 & aa$L1==X],na.rm = T)},aa=a))
abline(v=a1,col='brown')
abline(v=a2,col='green')
```

<p class='p_caption'>Azimuth (T7T12 - mRELBOW) >> 2nd step SF, 4th - 11th sub-movements</p>
```{r }
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2' & m_tList[['rdif1']]$L1!='m_3',]

a1=a[a$gr==0,]
a1=droplevels(a1)
a1=tapply(a1$value, a1$L1, summary)
a1=sapply(a1, "[", c("Mean"))
a1=describe(a1)

a2=a[a$gr==1,]
a2=droplevels(a2)
a2=tapply(a2$value, a2$L1, summary)
a2=sapply(a2, "[", c("Mean"))
a2=describe(a2)
a=rbind(a1,a2); rownames(a)=c('1st group', '2nd group')
#set.caption('Azimuth (T7T12 - mRELBOW) >> 2nd step SF, 4th - 11th sub-movements')
pander(a, use.hyphening = TRUE, style='rmarkdown')
```

<p class='p_caption'>Azimuth ( mLELBOW - T7T12)  >> 2nd step SF, 4th - 11th sub-movements</p>
``` {r } 
a=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2' & m_tList[['ldif1']]$L1!='m_3',]

a1=a[a$gr==0,]
a1=droplevels(a1)
a1=tapply(a1$value, a1$L1, summary)
a1=sapply(a1, "[", c("Mean"))
a1=describe(a1)

a2=a[a$gr==1,]
a2=droplevels(a2)
a2=tapply(a2$value, a2$L1, summary)
a2=sapply(a2, "[", c("Mean"))
a2=describe(a2)
a=rbind(a1,a2); rownames(a)=c('1st group', '2nd group')
#set.caption('Azimuth ( mLELBOW - T7T12)  >> 2nd step SF, 4th - 11th sub-movements')
pander(a, use.hyphening = TRUE, style='rmarkdown')
```

<p class='p_caption'>Azimuth (mRELBOW-mLELBOW) >> 2nd step SF, 4th - 11th sub-movements</p>
``` {r } 
a=m_tList[['sdif1']][m_tList[['sdif1']]$L1!='m_1' & m_tList[['sdif1']]$L1!='m_2' & m_tList[['sdif1']]$L1!='m_3',]

a1=a[a$gr==0,]
a1=droplevels(a1)
a1=tapply(a1$value, a1$L1, summary)
a1=sapply(a1, "[", c("Mean"))
a1=describe(a1)

a2=a[a$gr==1,]
a2=droplevels(a2)
a2=tapply(a2$value, a2$L1, summary)
a2=sapply(a2, "[", c("Mean"))
a2=describe(a2)
a=rbind(a1,a2); rownames(a)=c('1st group', '2nd group')
#set.caption('Azimuth (mRELBOW-mLELBOW) >> 2nd step SF, 4th - 11th sub-movements')
pander(a, use.hyphening = TRUE, style='rmarkdown')
```

Density plots of the angle values grouped by the 11 sub-movements. Brown color represents the 1st group and green the 2nd; vertical lines mark mean value of the corresponding sub-movement for 1st and 2nd group. The 2nd and 3rd rows capture a symmetrical motion sequence: from the left into right bow stance and from the right into left.

``` {r fig.height=10} 
a=m_tList[['rdif1']]

xl=c(min(a$value,na.rm = T),max(a$value,na.rm = T))
yl=c(0,7/(max(a$value,na.rm = T)-min(a$value,na.rm = T)))
#yl=c(0,.18)
par(mar=c(2.1, 1.9, 1.1, 1.9))
par(mfrow=c(3,4)) 
i=1
for(ii in 1:(length(unique(a$L1))+1)){
  if(ii==1){
    plot(1, type="n", axes=F, xlab="", ylab="")
    text(x=1,labels='Right', cex = 1.7,adj = c(.5,.5))}
  else{
tN=unique(a$L1)[i]
sm.density.compare(a$value[a$L1==tN & is.finite(a$value)], a$gr[a$L1==tN], xlab="degrees", xlim=xl,ylim=yl, col=c('brown','green'))
title(main=tN)
grid()
abline(v=mean(a$value[a$L1==tN & a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$L1==tN & a$gr==1],na.rm = T),col='green')

i=i+1
}
}

a=m_tList[['ldif1']]

xl=c(min(a$value,na.rm = T),max(a$value,na.rm = T))
yl=c(0,7/(max(a$value,na.rm = T)-min(a$value,na.rm = T)))
#yl=c(0,.18)
par(mar=c(2.1, 1.9, 1.1, 1.9))
par(mfrow=c(3,4)) 
i=1
for(ii in 1:(length(unique(a$L1))+1)){
  if(ii==1){
    plot(1, type="n", axes=F, xlab="", ylab="")
    text(x=1,labels='Left', cex = 1.7,adj = c(.5,.5))}
  else{
tN=unique(a$L1)[i]
sm.density.compare(a$value[a$L1==tN & is.finite(a$value)], a$gr[a$L1==tN], xlab="degrees", xlim=xl,ylim=yl, col=c('brown','green'))
title(main=tN)
grid()
abline(v=mean(a$value[a$L1==tN & a$gr==0],na.rm = T),col='brown')
abline(v=mean(a$value[a$L1==tN & a$gr==1],na.rm = T),col='green')

i=i+1
}
}

```

#### <a name="pN3"></a>Relative orientation of the upper arms in the horisontal plane, grouped by id-trials and sub-movements

Below are boxplots for two intervals of the 2nd step that capture symmetrical body motion: from the left to right bow stance and from the right to left bow stance. The boxplots of these intervals are superimposed for each of the trials. The **1st interval is marked by green** color and the **2nd by red** (color is not associated with groups). 

``` {r fig.height=18} 
a1=cbind(qa[['m_4']][,1],qa[['m_7']][,2])
a2=cbind(qa[['m_8']][,1],qa[['m_11']][,2])
a1=list(m_4_7=a1,m_8_11=a2)
ant4_2bow=f_getSubMove(a=rdif1, qa=a1)#right
ant4_2bow=melt(ant4_2bow)

ant1_2bow=f_getSubMove(a=ldif1, qa=a1)#left
ant1_2bow=melt(ant1_2bow)

dif_2bow=f_getSubMove(a=sdif1, qa=a1)#symmetry
dif_2bow=melt(dif_2bow)

par(mfrow=c(2,1)) 
par(mar=c(2.5, 4.5, 1.1, 1.5))

m_s_2bow=ant4_2bow

boxplot(value~L2, data=m_s_2bow, subset=L1=='m_4_7', horizontal=T,las=2,col=rgb(.5,1,.3, alpha=0.6), medcol="green", varwidth=T,cex.axis=.7, main='Right')
boxplot(value~L2, data=m_s_2bow, subset=L1=='m_8_11', horizontal=T,las=2,col=rgb(1,.3,.5, alpha=0.3),medcol="red",add=T, notch=TRUE, varwidth=T,cex.axis=.7)
grid()

abline(v=mean(m_s_2bow$value[m_s_2bow$L1=='m_4_7'],na.rm = T),col=rgb(.5,1,.3, alpha=0.8))
abline(v=mean(m_s_2bow$value[m_s_2bow$L1=='m_8_11'],na.rm = T),col=rgb(1,.3,.5, alpha=0.8))
#------------------------------left
m_s_2bow=ant1_2bow

boxplot(value~L2, data=m_s_2bow, subset=L1=='m_4_7', horizontal=T,las=2,col=rgb(.5,1,.3, alpha=0.6), medcol="green", varwidth=T,cex.axis=.7, main='Left')
boxplot(value~L2, data=m_s_2bow, subset=L1=='m_8_11', horizontal=T,las=2,col=rgb(1,.3,.5, alpha=0.3),medcol="red",add=T, notch=TRUE, varwidth=T,cex.axis=.7)
grid()

abline(v=mean(m_s_2bow$value[m_s_2bow$L1=='m_4_7'],na.rm = T),col=rgb(.5,1,.3, alpha=0.8))
abline(v=mean(m_s_2bow$value[m_s_2bow$L1=='m_8_11'],na.rm = T),col=rgb(1,.3,.5, alpha=0.8))

```

Also, we can differentiate between the different sub-movements within the two intervals and look at them individually. Below are two columns of the boxplots with 4 rows that represent consecutive phases of our two intervals. The 1st column represents the movement from the left to right bow stance (4th - 7th sub-movements), the 2nd column represents the movement from the right to left bow stance (8th - 11th sub-movements).

Brown and green color mark data of the angles for the right upper arm in the 1st and 2nd group. Pale semi-transparent yellow and cyan-green colors mark angles of the left upper arm for the 1st and 2nd group.

```{r fig.height=23}
#print boxplot of trial's mean-values for each sub-movement
par(mfrow=c(4,2)) 
par(mar=c(4.5, 4.5, 0.5, 1.5))
a=m_tList[['rdif1']][m_tList[['rdif1']]$L1!='m_1' & m_tList[['rdif1']]$L1!='m_2'  & m_tList[['rdif1']]$L1!='m_3',]

b=tList[['rdif1']]

a2=m_tList[['ldif1']][m_tList[['ldif1']]$L1!='m_1' & m_tList[['ldif1']]$L1!='m_2'  & m_tList[['ldif1']]$L1!='m_3',]

b2=tList[['ldif1']]

c2=c(rgb(1, .9, .1, alpha=.5),rgb(.1, 1, .8, alpha=.5))
c2=c(replicate(l1,c2[1]),replicate(l2,c2[2]))

xl=c(min(a$value,na.rm = T),max(a$value,na.rm = T))
#boxplot for mean-values of all sub-movements for each trial
boxplot(value ~ L1 , data = melt(b[['m_4']]), horizontal = TRUE, las=2, col = c2gr, ylim=xl,medcol='black')
boxplot(value ~ L1 , data = melt(b2[['m_4']]), horizontal = TRUE, las=2, col = c2,add=T,medcol='blue',notch=TRUE )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_4'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_4'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_4'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_4'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_8']]), horizontal = TRUE, las=2, col = c2gr, ylim=xl,medcol='black' )
boxplot(value ~ L1 , data = melt(b2[['m_8']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE  )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_8'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_8'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_8'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_8'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_5']]), horizontal = TRUE, las=2, col = c2gr, ylim=xl,medcol='black' )
boxplot(value ~ L1 , data = melt(b2[['m_5']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE  )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_5'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_5'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_5'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_5'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_9']]), horizontal = TRUE, las=2, col = c2gr, ylim=xl,medcol='black' )
boxplot(value ~ L1 , data = melt(b2[['m_9']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE  )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_9'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_9'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_9'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_9'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_6']]), horizontal = TRUE, las=2, col = c2gr , ylim=xl,medcol='black')
boxplot(value ~ L1 , data = melt(b2[['m_6']]), horizontal = TRUE, las=2, col = c2 , add=T,medcol='blue',notch=TRUE )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_6'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_6'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_6'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_6'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_10']]), horizontal = TRUE, las=2, col = c2gr, ylim=xl,medcol='black' )
boxplot(value ~ L1 , data = melt(b2[['m_10']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_10'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_10'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_10'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_10'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_7']]), horizontal = TRUE, las=2, col = c2gr , ylim=xl,medcol='black')
boxplot(value ~ L1 , data = melt(b2[['m_7']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_7'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_7'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_7'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_7'],na.rm = T),col='blue')

boxplot(value ~ L1 , data = melt(b[['m_11']]), horizontal = TRUE, las=2, col = c2gr , ylim=xl,medcol='black')
boxplot(value ~ L1 , data = melt(b2[['m_11']]), horizontal = TRUE, las=2, col = c2, add=T,medcol='blue',notch=TRUE )
grid()
abline(v=mean(a$value[a$gr==0 & a$L1=='m_11'],na.rm = T),col='brown')
abline(v=mean(a$value[a$gr==1 & a$L1=='m_11'],na.rm = T),col='green')
abline(v=mean(a2$value[a2$gr==0 & a2$L1=='m_11'],na.rm = T),col='orange')
abline(v=mean(a2$value[a2$gr==1 & a2$L1=='m_11'],na.rm = T),col='blue')

```

Furthermore we can compare the actual time series for the two intervals. The figure below shows 25 plots for each of the trials with the red/orange color marking the 2nd interval and green the 1st. Vertical lines show boundaries for the four sub-movements within each interval.

Horizontal axis is given in frames with sampling frequency 120 frames per second. 

Green colors are for the 1st interval (4-7th sub-movements; left to right bow stance) and red-like for the 2nd interval (8-11th sub-movements; right to left bow stance); darker colors are for the left upper arm and lighter colors for the right arm.

##### <a name="pN3_p1"></a> Right side (1-green & 2-orange), Left side (1-dark green & 2-red)

```{r }

tdo=as.data.frame(ant4_2bow)
#fdo=as.data.frame(dif_2bow)
tdo2=as.data.frame(ant1_2bow)

yl=c(min(c(tdo$value,tdo2$value),na.rm = T), 
     max(c(tdo$value,tdo2$value),na.rm = T))
xl=c(0,1700)
par(mfrow=c(5,5)) 
par(mar=c(2.1, 1.9, 1.1, 1.9))
for(i in 1:length(names(rdif1))){
  tN=names(rdif1)[i]
  
plot(tdo$value[tdo$L2==tN & tdo$L1=='m_4_7'],
       col=rgb(.5,1,.3, alpha=0.8),type='l',
       xlim=xl,ylim=yl,xaxt="n", main=tN, xlab ='', ylab ='')
points(tdo$value[tdo$L2==tN & tdo$L1=='m_8_11'], col=rgb(1,.5,.3, alpha=0.8),type='l')

points(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_4_7'], col='dark green',type='l')
points(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_8_11'], col='red',type='l',lwd=1)
  
  axis(side=1, at=seq(xl[1], xl[2], by=120))
  abline(h=0)
#   abline(h=t2001[['rdif1']][i], col=rgb(.5,1,.3, alpha=0.8),lty=2,lwd=.7)
#   abline(h=t2001[['ldif1']][i], col='dark green',lty=2,lwd=.7)
  
  abline(v=qa[['m_4']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_8']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_5']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_9']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_6']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_10']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  
}
```

Below are the time series for the difference between the right and left upper arms (mRELBOW_1-mLELBOW_1+2*sp4_1) in relation to the ribcage; in other words these values represent the motion of the upper arms relative to the ribcage. Time series for the 1st interval are in the green color and for the 2nd interval in the red color. The positive value indicates that the right arm is closer to the body midline (more protracted) than the left. The lines in the light grey color represent azimuth angles of the ribcage in the 1st interval and in the dark grey in the 2nd. The olive and pink colors mark absolute angle between upper arms in the horisontal plane (mRELBOW-mLELBOW) for the 1st and 2nd intervals respectively.

##### <a name="pN3_p2"></a>(mRELBOW-mLELBOW) (1-olive & 2-dark pink), T7T12 (1-light grey, 2-dark grey)<br>(T7T12-mLELBOW)-(mRELBOW-T7T12) (1-dark green & 2-red)

```{r }
tdo3=f_getSubMove(a=rbLE, qa=a1)
tdo3=melt(tdo3)
tdo3=as.data.frame(tdo3)

tdo=as.data.frame(ant4_2bow)
fdo=as.data.frame(dif_2bow)
tdo2=as.data.frame(ant1_2bow)

yl=c(min(c(tdo3$value,fdo$value,(tdo2$value-tdo$value)),na.rm = T), 
     max(c(tdo3$value,fdo$value,(tdo2$value-tdo$value)),na.rm = T))
xl=c(0,1700)
par(mfrow=c(5,5)) 
par(mar=c(2.1, 1.9, 1.1, 1.9))
for(i in 1:length(names(rdif1))){
  tN=names(rdif1)[i]
  

plot(fdo$value[fdo$L2==tN & fdo$L1=='m_4_7'], 
       xlim=xl,ylim=yl,xaxt="n", main=tN, xlab ='', ylab ='', 
       lty=1, col='olivedrab',type='l',lwd=1.7)

points(fdo$value[fdo$L2==tN & fdo$L1=='m_8_11'], 
       lty=1, col='hotpink',type='l',lwd=1.7)

points(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_4_7']-tdo$value[tdo$L2==tN & tdo$L1=='m_4_7'],
       col='dark green',type='l',lwd=1.7,lty=1)

points(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_8_11']-tdo$value[tdo$L2==tN & tdo$L1=='m_8_11'],
       col='red',type='l',lwd=1.7,lty=1)

points(tdo3$value[tdo3$L2==tN & tdo3$L1=='m_4_7'],
       col='lightskyblue3',type='l',lwd=0.8,lty=1)

points(tdo3$value[tdo3$L2==tN & tdo3$L1=='m_8_11'],
       col='lightskyblue4',type='l',lwd=0.8,lty=1)
  
  axis(side=1, at=seq(xl[1], xl[2], by=120))
  abline(h=0)
#   abline(h=t2001[['rdif1']][i], col=rgb(.5,1,.3, alpha=0.8),lty=2,lwd=.7)
#   abline(h=t2001[['ldif1']][i], col='dark green',lty=2,lwd=.7)
  
  abline(v=qa[['m_4']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_8']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_5']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_9']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_6']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_10']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  
}
```


##### <a name="pN3_p3"></a>T7T12 (1-light grey, 2-dark grey), (T7T12-mLELBOW)-(mRELBOW-T7T12) (1-dark green & 2-red)

```{r }
tdo3=f_getSubMove(a=rbLE, qa=a1)
tdo3=melt(tdo3)
tdo3=as.data.frame(tdo3)

tdo=as.data.frame(ant4_2bow)
tdo2=as.data.frame(ant1_2bow)

yl=c(min(c(tdo3$value,(tdo2$value-tdo$value)),na.rm = T), 
     max(c(tdo3$value,(tdo2$value-tdo$value)),na.rm = T))
xl=c(0,1700)
par(mfrow=c(5,5)) 
par(mar=c(2.1, 1.9, 1.1, 1.9))
for(i in 1:length(names(rdif1))){
  tN=names(rdif1)[i]
  

plot(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_4_7']-tdo$value[tdo$L2==tN & tdo$L1=='m_4_7'],
       xlim=xl,ylim=yl,xaxt="n", main=tN, xlab ='', ylab ='', 
     col='dark green',type='l',lwd=1.7,lty=1)

points(tdo2$value[tdo2$L2==tN & tdo2$L1=='m_8_11']-tdo$value[tdo$L2==tN & tdo$L1=='m_8_11'],
       col='red',type='l',lwd=1.7,lty=1)

points(tdo3$value[tdo3$L2==tN & tdo3$L1=='m_4_7'],

              col='lightskyblue3',type='l',lwd=0.8,lty=1)

points(tdo3$value[tdo3$L2==tN & tdo3$L1=='m_8_11'],
       col='lightskyblue4',type='l',lwd=0.8,lty=1)
  
  axis(side=1, at=seq(xl[1], xl[2], by=120))
  abline(h=0)
  
  abline(v=qa[['m_4']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_8']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_5']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_9']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  abline(v=qa[['m_6']][tN,2]-qa[['m_4']][tN,1],col=rgb(1,.5,.3, alpha=0.6))
  abline(v=qa[['m_10']][tN,2]-qa[['m_8']][tN,1],col=rgb(.5,1,.3, alpha=0.6))
  
}

```
